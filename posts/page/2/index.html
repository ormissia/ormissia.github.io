<!doctype html><html lang=zh-cn><head><title>Posts</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/application.c13c3a6e28cb475227c4fc3039a34855f6ce82ad1f35abc4d95045b7374b68e3.css integrity="sha256-wTw6bijLR1InxPwwOaNIVfbOgq0fNavE2VBFtzdLaOM="><link rel=icon type=image/png href=/images/favicon_hu8376fd15465fef26ffe66b6bcf0ca686_13669_42x0_resize_box_3.png><meta property="og:title" content="Posts"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://ormissia.github.io/posts/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Posts"><meta name=twitter:description content><script>theme=localStorage.getItem("darkmode:color-scheme")||"system",theme=="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-posts kind-section" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i></button>
<a class=navbar-brand href=/><img src=/images/ormissia_hu763a76473558eea2a316ef50b45aaecf_966068_42x0_resize_box_3.png id=logo alt=Logo>
Ormissia's Blog</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-toggle=collapse data-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/#home>主页</a></li><li class=nav-item><a class=nav-link href=/#about>技能</a></li><li class=nav-item><a class=nav-link href=/#recent-posts>最近</a></li><li class=nav-item><a class=nav-link href=/#education>历程</a></li><li class=nav-item><a class=nav-link href=/#projects>项目</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>更多的</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=/#achievements>成就</a></div></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/posts>博文</a></li><li class=nav-item><a class=nav-link id=note-link href=/notes>笔记</a></li><li class=nav-item><a class=nav-link href=https://github.com/ormissia>GitHub</a></li></ul></div></div><img src=/images/ormissia_hu763a76473558eea2a316ef50b45aaecf_966068_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/ormissia_hu763a76473558eea2a316ef50b45aaecf_966068_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=搜索 data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>博文</a></li><div class=subtree><li><i data-feather=plus-circle></i><a class=list-link href=/posts/knowledge/> 知识积累</a><ul><li><i data-feather=plus-circle></i><a class=list-link href=/posts/knowledge/2001-go/> Go</a><ul><li><a class=list-link href=/posts/knowledge/2001-go/001-partten-1/ title=函数选项模式>函数选项模式</a></li><li><a class=list-link href=/posts/knowledge/2001-go/002-param-verify/ title=实体参数校验>实体参数校验</a></li><li><a class=list-link href=/posts/knowledge/2001-go/003-reflect/ title=Golang反射>Golang反射</a></li><li><a class=list-link href=/posts/knowledge/2001-go/004-pprof/ title=pprof>pprof</a></li><li><a class=list-link href=/posts/knowledge/2001-go/005-tag/ title="Golang struct tag">Golang struct tag</a></li><li><a class=list-link href=/posts/knowledge/2001-go/006-atomic/ title=Golang中的原子操作>Golang中的原子操作</a></li><li><a class=list-link href=/posts/knowledge/2001-go/007-cacheline/ title=全局变量加锁的优化>全局变量加锁的优化</a></li></ul></li><li><a class=list-link href=/posts/knowledge/2002-rust/ title=Rust>Rust</a></li><li><a class=list-link href=/posts/knowledge/2003-scala/ title=Scala>Scala</a></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/knowledge/2004-network/> Network</a><ul><li><a class=list-link href=/posts/knowledge/2004-network/001-oauth/ title="OAuth 2.0扩展协议PKCE">OAuth 2.0扩展协议PKCE</a></li><li><a class=list-link href=/posts/knowledge/2004-network/002-http_statuscode/ title=HTTP笔记>HTTP笔记</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/knowledge/2005-operating-system/> Operating System</a><ul><li><a class=list-link href=/posts/knowledge/2005-operating-system/001-io-network/ title=网络IO演进历程>网络IO演进历程</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/knowledge/2010-elastic/> Elastic</a><ul><li><a class=list-link href=/posts/knowledge/2010-elastic/001-elasticstack-es/ title=Elasticsearch>Elasticsearch</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/knowledge/2006-hadoop/> Hadoop</a><ul><li><a class=list-link href=/posts/knowledge/2006-hadoop/001-env/ title=Hadoop生态组件>Hadoop生态组件</a></li><li><a class=list-link href=/posts/knowledge/2006-hadoop/2007-hadoop-hdfs/ title=HDFS基础知识>HDFS基础知识</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/knowledge/2007-kubernetes/> Kubernetes</a><ul><li><a class=list-link href=/posts/knowledge/2007-kubernetes/001-link-index/ title=Kubernetes文档索引>Kubernetes文档索引</a></li><li><a class=list-link href=/posts/knowledge/2007-kubernetes/002-handless-statefullset/ title=k8s中通过Headless连接StatefulSet>k8s中通过Headless连接StatefulSet</a></li></ul></li><li><a class=list-link href=/posts/knowledge/2008-mysql/ title=Mysql>Mysql</a></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/knowledge/2009-redis/> Redis</a><ul><li><a class=list-link href=/posts/knowledge/2009-redis/001-cache/ title=Redis缓存相关问题>Redis缓存相关问题</a></li></ul></li><li><a class=list-link href=/posts/knowledge/2012-framework/ title=Framework>Framework</a></li><li><a class=list-link href=/posts/knowledge/2011-react-note/ title=React学习笔记>React学习笔记</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/deployment/> 环境部署</a><ul><li><a class=list-link href=/posts/deployment/3001-blog-cicd/ title=我的博客后端Docker镜像打包自动部署流程>我的博客后端Docker镜像打包自动部署流程</a></li><li><a class=list-link href=/posts/deployment/3002-linux-nginx/ title=Linux部署Nginx流程>Linux部署Nginx流程</a></li><li><a class=list-link href=/posts/deployment/3003-linux-traefik/ title=Traefik部署流程>Traefik部署流程</a></li><li><a class=list-link href=/posts/deployment/3004-linux-grafana/ title=Grafana部署流程>Grafana部署流程</a></li><li><a class=list-link href=/posts/deployment/3005-linux-prometheus/ title=Prometheus部署流程>Prometheus部署流程</a></li><li><a class=list-link href=/posts/deployment/3006-linux-elk/ title=ELK部署流程>ELK部署流程</a></li><li><a class=list-link href=/posts/deployment/3007-linux-kubernetes/ title=Linux部署Kubernetes流程>Linux部署Kubernetes流程</a></li><li><a class=list-link href=/posts/deployment/3008-linux-redis/ title=Redis默认配置文件修改>Redis默认配置文件修改</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/algorithm/> 算法</a><ul><li><a class=list-link href=/posts/algorithm/4001-algorithm-sort/ title=排序算法>排序算法</a></li><li><a class=list-link href=/posts/algorithm/4002-algorithm-trie/ title=前缀树>前缀树</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/problems/> 疑难杂症</a><ul><li><a class=list-link href=/posts/problems/5001-go-online-service-oom/ title=记一次线上的内存持续增长问题>记一次线上的内存持续增长问题</a></li><li><a class=list-link href=/posts/problems/5002-k8s-memory/ title=Grafana上监控不准问题排查>Grafana上监控不准问题排查</a></li><li><a class=list-link href=/posts/problems/5003-elasticsearch-start-failed/ title=CentOS安装完ES无法启动>CentOS安装完ES无法启动</a></li><li><a class=list-link href=/posts/problems/5004-kubernetes-dashboard-token/ title="k8s dashboard token过期时间太短">k8s dashboard token过期时间太短</a></li><li><a class=list-link href=/posts/problems/5005-docker-image-source/ title=修改Docker镜像源>修改Docker镜像源</a></li><li><a class=list-link href=/posts/problems/5006-mysql-brew-conf/ title=修改Mac上brew安装的MySQL配置>修改Mac上brew安装的MySQL配置</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/booknotes/> 读书笔记</a><ul><li><i data-feather=plus-circle></i><a class=list-link href=/posts/booknotes/6001-ddia/> DDIA</a><ul><li><a class=list-link href=/posts/booknotes/6001-ddia/001-ddia/ title=数据密集型应用系统设计(DDIA)读书笔记>数据密集型应用系统设计(DDIA)读书笔记</a></li><li><a class=list-link href=/posts/booknotes/6001-ddia/002-ddia/ title=数据密集型应用系统设计(DDIA)读书笔记>数据密集型应用系统设计(DDIA)读书笔记</a></li><li><a class=list-link href=/posts/booknotes/6001-ddia/003-ddia/ title=数据密集型应用系统设计(DDIA)读书笔记>数据密集型应用系统设计(DDIA)读书笔记</a></li></ul></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class="content container-fluid" id=content><div class="container-fluid post-card-holder" id=post-card-holder><div class=post-card><a href=/posts/knowledge/2007-kubernetes/001-link-index/ class=post-card-link><div class=card><div class=card-head><img class=card-img-top src=/posts/knowledge/2007-kubernetes/001-link-index/head.svg alt="Hero Image"></div><div class=card-body><h5 class=card-title>Kubernetes文档索引</h5><p class="card-text post-summary">#kubernetes #k8s
为系统守护进程预留计算资源 开启服务拓扑 Master节点的高可用 Service 的 DNS</p></div><div class=card-footer><span class=float-left>November 4, 2021</span>
<a href=/posts/knowledge/2007-kubernetes/001-link-index/ class="float-right btn btn-outline-info btn-sm">阅读</a></div></div></a></div><div class=post-card><a href=/posts/problems/5005-docker-image-source/ class=post-card-link><div class=card><div class=card-head><img class=card-img-top src=/posts/problems/5005-docker-image-source/head.svg alt="Hero Image"></div><div class=card-body><h5 class=card-title>修改Docker镜像源</h5><p class="card-text post-summary">#docker
问题现象 国内某些网络环境下，会出现docker pull无法拉取镜像的情况
解决办法 修改Docker镜像源
新建或修改
vi /etc/docker/daemon.json { "registry-mirrors": [ "http://hub-mirror.c.163.com" ] } 最后重启Docker
systemctl restart docker.service</p></div><div class=card-footer><span class=float-left>November 4, 2021</span>
<a href=/posts/problems/5005-docker-image-source/ class="float-right btn btn-outline-info btn-sm">阅读</a></div></div></a></div><div class=post-card><a href=/posts/knowledge/2007-kubernetes/002-handless-statefullset/ class=post-card-link><div class=card><div class=card-head><img class=card-img-top src=/posts/knowledge/2007-kubernetes/002-handless-statefullset/head.svg alt="Hero Image"></div><div class=card-body><h5 class=card-title>k8s中通过Headless连接StatefulSet</h5><p class="card-text post-summary">#kubernetes #k8s
连接一些多实例的服务（比如Kafka、ES）时，通常是在client端做负载均衡。
假如这种集群又恰好跑在k8s中，如果是普通业务类型的服务，通常是创建一个Service来做为一个代理去访问不同实例，从而达到负载均衡的目的。
但是诸如如：Kafka、ES类型的服务，还用Service来做负载均衡，显然就不那么合理了（诚然，Kafka、ES这种东西多半是不会跑在k8s上的，这里只是作为一个引子，不在本文讨论的范畴）。
实验环境 多实例服务whoami在kube-test-1的命名空间下 多实例服务whoami以StatefulSet方式部署，设置为3个实例，会自动创建whoami-0、whoami-1以及whoami-2三个Pod 给StatefulSet创建Headless类型的Service 模拟客户端使用Nginx镜像，部署在kube-test-2的命名空间下（使用curl命令模拟） 本实验创建资源使用的k8s dashboard，创建的资源默认放在选中的明明空间下，因此yml文件中未指定namespace。
Server cluster 服务端模拟相关资源在kube-test-1下创建
StatefulSet 使用traefik/whoami镜像来模拟服务端
这里使用StatefulSet的方式创建服务端。spec.replicas设为3，此时会自动创建whoami-0、whoami-1以及whoami-2三个Pod。
apiVersion: apps/v1 kind: StatefulSet metadata: name: whoami labels: app: whoami spec: replicas: 3 selector: matchLabels: app: whoami serviceName: whoami template: metadata: name: whoami labels: app: whoami spec: containers: - name: whoami image: traefik/whoami ports: - containerPort: 80 注意这里的spec.serviceName必须与下面的Service名字相同，否则调用时候pod的subdomain只能使用IP
$ k get pod -n kube-test-1 -o wide | grep whoami whoami-0 1/1 Running 0 29m 10.</p></div><div class=card-footer><span class=float-left>November 1, 2021</span>
<a href=/posts/knowledge/2007-kubernetes/002-handless-statefullset/ class="float-right btn btn-outline-info btn-sm">阅读</a></div></div></a></div><div class=post-card><a href=/posts/problems/5004-kubernetes-dashboard-token/ class=post-card-link><div class=card><div class=card-head><img class=card-img-top src=/posts/problems/5004-kubernetes-dashboard-token/head.svg alt="Hero Image"></div><div class=card-body><h5 class=card-title>k8s dashboard token过期时间太短</h5><p class="card-text post-summary">#kubernetes #k8s #token #dashboard
问题现象 kubernetes的dashboard登录token过期时间太短，不操作没一会就需要重新登录
解决办法 修改kubernetes-dashboard的deployment，加入一条arg参数：
- '--token-ttl=10800'</p></div><div class=card-footer><span class=float-left>November 1, 2021</span>
<a href=/posts/problems/5004-kubernetes-dashboard-token/ class="float-right btn btn-outline-info btn-sm">阅读</a></div></div></a></div><div class=post-card><a href=/posts/knowledge/2010-elastic/001-elasticstack-es/ class=post-card-link><div class=card><div class=card-head><img class=card-img-top src=/posts/knowledge/2010-elastic/001-elasticstack-es/head.svg alt="Hero Image"></div><div class=card-body><h5 class=card-title>Elasticsearch</h5><p class="card-text post-summary">#elasticsearch #elastic #db #search-engine #lucene
搜索类型 搜索引擎：百度、搜狗、谷歌、必应 垂直领域：各大电商平台、OA系统、站内搜索 商业智能：数据分析、数据挖掘、用户画像 GitHub：千亿+行代码秒查 日志系统：ELK ES特点 搜索、聚合分析、大数据存储 分布式、高性能、高可用、可伸缩、易维护 支持文本搜索、结构化数据、非结构化数据、地理位置搜索等 ES单机部署 同一节点启动不同服务 ./bin/elasticsearch -E path.data=data1 -E path.logs=log1 -E node.name=node1 -E cluster.name=ormissia_test ./bin/elasticsearch -E path.data=data2 -E path.logs=log2 -E node.name=node2 -E cluster.name=ormissia_test http://localhost:9200/ http://localhost:9201/ 不同节点启动同一服务 open ./elasticsearch_node1/bin/elasticsearch open ./elasticsearch_node2/bin/elasticsearch open ./elasticsearch_node3/bin/elasticsearch open ./elasticsearch_node4/bin/elasticsearch open ./elasticsearch_node5/bin/elasticsearch open ./kibana-7.15.1-darwin-x86_64/bin/kibana elasticsearch-head插件 GitHub Repository
git clone git://github.com/mobz/elasticsearch-head.git cd elasticsearch-head npm install npm run start 默认端口：9100
如果集群无法连接，需要修改ES配置文件
http.cors.enabled: true http.cors.allow-origin: "*" elasticsearch-head也可以以Chrome插件的方式安装</p></div><div class=card-footer><span class=float-left>October 19, 2021</span>
<a href=/posts/knowledge/2010-elastic/001-elasticstack-es/ class="float-right btn btn-outline-info btn-sm">阅读</a></div></div></a></div><div class=post-card><a href=/posts/deployment/3007-linux-kubernetes/ class=post-card-link><div class=card><div class=card-head><img class=card-img-top src=/posts/deployment/3007-linux-kubernetes/head.svg alt="Hero Image"></div><div class=card-body><h5 class=card-title>Linux部署Kubernetes流程</h5><p class="card-text post-summary">此次安装的平台是基于ARM架构的RedHat系Linux系统平台，参照Kubernetes官方文档进行的。
本文档流程与X86架构的没有区别，官方文档中个别步骤中的命令需要区分所使用的包对应的平台。
初始化环境 防火墙 systemctl stop firewalld.service systemctl disable firewalld.service SELinux vi /etc/selinux/config SELINUX=disabled Swap vi /etc/fstab 注释掉swap这一行
/.swapfile none swap sw,comment=cloudconfig 0 0 重启之后查看关闭是否成功
free -m 显示如下内容，swap关闭成功
total used free shared buff/cache available Mem: 23114 402 22299 32 411 20597 Swap: 0 0 0 ulimit echo "ulimit -n 65535" >> /etc/profile echo "* hard nofile 65535" >> /etc/security/limits.conf 重启之后检查是否配置成功
ulimit -n SSH免密（非必须） 执行命令，一路回车，即可获得当前节点的公钥
ssh-keygen -t rsa cat id_rsa.pub iptables 查看br_netfilter模块是否开启</p></div><div class=card-footer><span class=float-left>October 14, 2021</span>
<a href=/posts/deployment/3007-linux-kubernetes/ class="float-right btn btn-outline-info btn-sm">阅读</a></div></div></a></div><div class=post-card><a href=/posts/problems/5003-elasticsearch-start-failed/ class=post-card-link><div class=card><div class=card-head><img class=card-img-top src=/posts/problems/5003-elasticsearch-start-failed/head.svg alt="Hero Image"></div><div class=card-body><h5 class=card-title>CentOS安装完ES无法启动</h5><p class="card-text post-summary">#elastic #elasticsearch
问题现象 按照ES官网文档介绍的安装步骤，使用yum的方式进行安装。安装完成之后，使用如下命令启动：
systemctl start elasticsearch.service 控制台阻塞一会后，显示启动失败，使用如下命令查看状态：
systemctl status elasticsearch.service 查询状态为：
Warning: The unit file, source configuration file or drop-ins of elasticsearch.service changed on disk. Run 'systemctl daemon-reload' to reload units. ● elasticsearch.service - Elasticsearch Loaded: loaded (/usr/lib/systemd/system/elasticsearch.service; disabled; vendor preset: disabled) Active: failed (Result: timeout) since Thu 2021-10-14 00:42:40 CST; 2min 15s ago Docs: https://www.elastic.co Main PID: 2547 (code=exited, status=143) Oct 14 00:41:22 gateway systemd[1]: Starting Elasticsearch... Oct 14 00:41:29 gateway bash[2547]: [0.</p></div><div class=card-footer><span class=float-left>October 14, 2021</span>
<a href=/posts/problems/5003-elasticsearch-start-failed/ class="float-right btn btn-outline-info btn-sm">阅读</a></div></div></a></div><div class=post-card><a href=/posts/deployment/3006-linux-elk/ class=post-card-link><div class=card><div class=card-head><img class=card-img-top src=/posts/deployment/3006-linux-elk/head.svg alt="Hero Image"></div><div class=card-body><h5 class=card-title>ELK部署流程</h5><p class="card-text post-summary">Elasticsearch Deployment&amp;Service apiVersion: apps/v1 kind: StatefulSet metadata: labels: app: elasticsearch role: master name: elasticsearch-master spec: replicas: 3 revisionHistoryLimit: 10 selector: matchLabels: app: elasticsearch role: master serviceName: es-master template: metadata: labels: app: elasticsearch role: master spec: serviceAccountName: elasticsearch-admin affinity: podAntiAffinity: requiredDuringSchedulingIgnoredDuringExecution: - topologyKey: kubernetes.io/hostname labelSelector: matchExpressions: - key: role operator: In values: - master containers: - name: elasticsearch-master image: elasticsearch:7.14.2 lifecycle: postStart: exec: command: [ "/bin/bash", "-c", "sysctl -w vm.max_map_count=262144; ulimit -l unlimited; chown -R elasticsearch:elasticsearch /usr/share/elasticsearch/data;" ] ports: - containerPort: 9200 protocol: TCP - containerPort: 9300 protocol: TCP resources: limits: cpu: 100m memory: 1Gi requests: cpu: 10m memory: 512Mi env: - name: MY_POD_NAME valueFrom: fieldRef: fieldPath: metadata.</p></div><div class=card-footer><span class=float-left>October 13, 2021</span>
<a href=/posts/deployment/3006-linux-elk/ class="float-right btn btn-outline-info btn-sm">阅读</a></div></div></a></div><div class=post-card><a href=/posts/deployment/3005-linux-prometheus/ class=post-card-link><div class=card><div class=card-head><img class=card-img-top src=/posts/deployment/3005-linux-prometheus/head.png alt="Hero Image"></div><div class=card-body><h5 class=card-title>Prometheus部署流程</h5><p class="card-text post-summary">程序下载 wget https://github.com/prometheus/prometheus/releases/download/v2.30.3/prometheus-2.30.3.linux-amd64.tar.gz 解压并移动 tar -zxvf prometheus-2.30.3.linux-amd64.tar.gz mv prometheus-2.30.3.linux-amd64 /usr/local/prometheus 添加到系统服务 Unit配置文件 vi /usr/lib/systemd/system/prometheus.service [Unit] Description=Prometheus Documentation=https://prometheus.io [Service] Type=simple ExecStart=/usr/local/prometheus/prometheus \ --config.file=/usr/local/prometheus/prometheus.yml \ --storage.tsdb.path=/usr/local/prometheus/data Restart=on-failure WatchdogSec=10s [Install] WantedBy=multi-user.target 启动程序 sudo systemctl daemon-reload sudo systemctl start prometheus.service sudo systemctl status prometheus.service 开机自启 sudo systemctl enable prometheus.service 简单使用 Prometheus默认端口是9090，程序启动之后从浏览器访问页面。
输入以下表达式来绘制在自抓取Prometheus中发生的每秒HTTP请求率返回状态代码200的图表：
rate(promhttp_metric_handler_requests_total{code="200"}[1m]) 配置文件 重新加载 curl -X POST http://127.0.0.1:9090/-/reload Kubernetes部署脚本 Deployment&amp;Service apiVersion: apps/v1 kind: Deployment metadata: name: prometheus labels: app: prometheus spec: replicas: 1 strategy: rollingUpdate: maxSurge: 1 maxUnavailable: 1 type: RollingUpdate selector: matchLabels: app: prometheus template: metadata: labels: app: prometheus spec: initContainers: - name: prometheus-data-permission-setup image: busybox command: ["/bin/chmod","-R","777", "/data"] volumeMounts: - name: prometheus-data mountPath: /data containers: - name: prometheus image: prom/prometheus args: - '--storage.</p></div><div class=card-footer><span class=float-left>October 9, 2021</span>
<a href=/posts/deployment/3005-linux-prometheus/ class="float-right btn btn-outline-info btn-sm">阅读</a></div></div></a></div><div class=post-card><a href=/posts/deployment/3004-linux-grafana/ class=post-card-link><div class=card><div class=card-head><img class=card-img-top src=/posts/deployment/3004-linux-grafana/head.png alt="Hero Image"></div><div class=card-body><h5 class=card-title>Grafana部署流程</h5><p class="card-text post-summary">Grafana的安装比较简单，打开官网下载页面，选择对应的系统以及需要的版本号，按照指引执行命令即可。
程序下载 wget https://dl.grafana.com/enterprise/release/grafana-enterprise-8.2.0-1.x86_64.rpm sudo yum install grafana-enterprise-8.2.0-1.x86_64.rpm 启动程序 sudo systemctl daemon-reload sudo systemctl start grafana-server sudo systemctl status grafana-server 验证 Grafana默认端口为:3000，默认用户名密码均为admin，程序启动后即可通过3000端口访问管理页面。
开机自启 sudo systemctl enable grafana-server Kubernetes部署脚本 Deployment&amp;Service apiVersion: apps/v1 kind: Deployment metadata: name: grafana labels: app: grafana spec: selector: matchLabels: app: grafana template: metadata: labels: app: grafana spec: affinity: podAntiAffinity: preferredDuringSchedulingIgnoredDuringExecution: - podAffinityTerm: topologyKey: kubernetes.io/hostname labelSelector: matchExpressions: - key: role operator: In values: - data weight: 100 containers: - name: grafana image: grafana/grafana-enterprise ports: - containerPort: 3000 env: - name: GF_PATHS_CONFIG value: /etc/grafana/grafana.</p></div><div class=card-footer><span class=float-left>October 9, 2021</span>
<a href=/posts/deployment/3004-linux-grafana/ class="float-right btn btn-outline-info btn-sm">阅读</a></div></div></a></div><div class=post-card><a href=/posts/deployment/3003-linux-traefik/ class=post-card-link><div class=card><div class=card-head><img class=card-img-top src=/posts/deployment/3003-linux-traefik/head.png alt="Hero Image"></div><div class=card-body><h5 class=card-title>Traefik部署流程</h5><p class="card-text post-summary">Traefik is an open-source Edge Router that makes publishing your services a fun and easy experience. It receives requests on behalf of your system and finds out which components are responsible for handling them. What sets Traefik apart, besides its many features, is that it automatically discovers the right configuration for your services. The magic happens when Traefik inspects your infrastructure, where it finds relevant information and discovers which service serves which request.</p></div><div class=card-footer><span class=float-left>October 9, 2021</span>
<a href=/posts/deployment/3003-linux-traefik/ class="float-right btn btn-outline-info btn-sm">阅读</a></div></div></a></div><div class=post-card><a href=/posts/deployment/3002-linux-nginx/ class=post-card-link><div class=card><div class=card-head><img class=card-img-top src=/posts/deployment/3002-linux-nginx/head.svg alt="Hero Image"></div><div class=card-body><h5 class=card-title>Linux部署Nginx流程</h5><p class="card-text post-summary">安装依赖 编译工具及库文件 yum -y install make zlib zlib-devel gcc-c++ libtool openssl openssl-devel 安装PCRE PCRE作用是让Nginx支持Rewrite功能
PCRE安装包下载地址： https://sourceforge.net/projects/pcre/files/pcre/
选择对应版本下载即可
下载PCRE安装包 cd /usr/local/src/ wget http://downloads.sourceforge.net/project/pcre/pcre/8.45/pcre-8.45.tar.gz 解压安装包并进入目录 tar -zxvf pcre-8.45.tar.gz cd pcre-8.45 编译安装 ./configure make && make install 验证安装 pcre-config --version 可能遇到的问题 安装完成之后有可能找不到命令，查看编译安装时的默认安装目录，将其添加到Linux环境变量PATH即可
创建管理Nginx的用户和组 创建nginx运行用户nginx并加入到nginx组，不允许nginx用户直接登录系统
groupadd nginx useradd -g nginx nginx -s /sbin/nologin 安装Nginx 下载安装包 Nginx下载地址： http://nginx.org/en/download.html
没有特殊需求的话，选择Stable version稳定版下载即可
cd /usr/local/src/ wget http://nginx.org/download/nginx-1.20.1.tar.gz 解压安装包并进入目录 tar -zxvf nginx-1.20.1 cd nginx-1.20.1 编译安装 ./configure \ --prefix=/usr/local/nginx \ --user=nginx --group=nginx \ --pid-path=/var/run/nginx/nginx.</p></div><div class=card-footer><span class=float-left>October 8, 2021</span>
<a href=/posts/deployment/3002-linux-nginx/ class="float-right btn btn-outline-info btn-sm">阅读</a></div></div></a></div></div><div class=paginator><ul class="pagination pagination-default"><li class=page-item><a href=/posts/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/posts/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/posts/ aria-label="Page 1" class=page-link role=button>1</a></li><li class="page-item active"><a aria-current=page aria-label="Page 2" class=page-link role=button>2</a></li><li class=page-item><a href=/posts/page/3/ aria-label="Page 3" class=page-link role=button>3</a></li><li class=page-item><a href=/posts/page/3/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/posts/page/3/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>联系方式:</h5><ul><li><span>QQ:</span> <span>1432050813</span></li><li><a href=mailto:ormissia@outlook.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>ormissia@outlook.com</span></a></li></ul></div></div></div><hr><div class=container><p id=disclaimer><strong>免责声明:</strong> 老铁看到底了，要负责的哦</p></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2021 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.fce84248fa0ec9c9a15fd3666a471073f96ec56b907861659921f9aea95d9e92.js integrity="sha256-/OhCSPoOycmhX9NmakcQc/luxWuQeGFlmSH5rqldnpI=" defer></script></body></html>