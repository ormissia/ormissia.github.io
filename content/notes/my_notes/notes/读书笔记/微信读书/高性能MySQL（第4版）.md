---
doc_type: weread-highlights-reviews
bookId: "3300035678"
author: Silvia Botros   Jeremy Tinley
cover: https://cdn.weread.qq.com/weread/cover/5/cpPlatform_tpeiJyaZriAkSeauDycVY8/t7_cpPlatform_tpeiJyaZriAkSeauDycVY8.jpg
reviewCount: 1
noteCount: 21
readingStatus: 在读
progress: 50%
totalReadDay: 15
readingTime: 24小时33分钟
readingDate: 2023-12-12
isbn: 9787121442575
lastReadDate: 2024-01-09

---
# 高性能MySQL（第4版）

#读书笔记 #计算机 #数据库

# 元数据
> [!abstract] 高性能MySQL（第4版）
> - ![ 高性能MySQL（第4版）|200](https://cdn.weread.qq.com/weread/cover/5/cpPlatform_tpeiJyaZriAkSeauDycVY8/t7_cpPlatform_tpeiJyaZriAkSeauDycVY8.jpg)
> - 书名： 高性能MySQL（第4版）
> - 作者： Silvia Botros   Jeremy Tinley
> - 简介： 《高性能 MySQL》一直是 MySQL 领域的经典之作，影响了一代又一代的 DBA 和技术人员，从第3 版出版到第 4 版出版过去了近十年，MySQL 也从 5.5 版本更新到了 8.0 版本。第 4 版中增加了大量对 MySQL 5.7 和 8.0 版本新特性的介绍，删除了一些在新版本中已经废弃或者不再常用的功能，还增加了对云数据库的介绍，减少了在官方文档中已有的基础使用和配置相关的内容。这些年，MySQL 经过在大量大规模互联网场景中的应用验证，使得本书在继续关注高性能之外，还用了较多的篇幅来介绍如何实现 MySQL 的大规模可扩展应用和合规性问题，这是相比第 3 版最大的不同，也是本书封面上所写的“经过大规模运维验证的策略”的体现。本书适合数据库管理员（DBA）阅读，也适合系统运维和开发人员参考学习。不管你是数据库新手还是专家，相信都能从本书中有所收获。
> - 出版时间 2022-09-01 00:00:00
> - ISBN： 9787121442575
> - 分类： 计算机-数据库
> - 出版社： 电子工业出版社
> - PC地址：https://weread.qq.com/web/reader/00a32b70813ab746fg018ec7

# 高亮划线

## 第6章 schema设计与管理

> 📌 DATETIME和TIMESAMP列可以存储相同类型的数据：时间和日期，精确到秒。然而TIMESTAMP只使用DATETIME一半的存储空间，还会根据时区变化，而且具有特殊的自动更新能力。另一方面，TIMESTAMP允许的时间范围要小得多，有时候它的特殊能力会成为障碍。  
> ⏱ 2024-01-02 14:32:36 ^3300035678-16-2521-2656

> 📌 MySQL可以为整数类型指定宽度，例如，INT(11)，这对大多数应用毫无意义：它不会限制值的合法范围，只是规定了MySQL的一些交互工具（例如，MySQL命令行客户端）用来显示字符的个数。对于存储和计算来说，INT(1)和INT(20)是相同的。  
> ⏱ 2024-01-02 14:36:30 ^3300035678-16-3741-3865

> 📌 在一些大容量的场景，可以考虑使用BIGINT代替DECIMAL，将需要存储的货币单位根据小数的位数乘以相应的倍数即可。假设要存储财务数据并精确到万分之一分，则可以把所有金额乘以一百万，然后将结果存储在BIGINT里，这样可以同时避免浮点存储计算不精确和DECIMAL精确计算代价高的问题。  
> ⏱ 2024-01-02 14:39:40 ^3300035678-16-4511-4655

> 📌 CHAR适合存储非常短的字符串，或者适用于所有值的长度都几乎相同的情况  
> ⏱ 2024-01-02 14:43:07 ^3300035678-16-6006-6041

> 📌 MySQL不能将BLOB和TEXT数据类型的完整字符串放入索引，也不能使用索引进行排序。  
> ⏱ 2024-01-02 14:48:25 ^3300035678-16-8643-8687

> 📌 对于完全“随机”的字符串要非常小心，如MD5()、SHA1()或UUID()生成的字符串。这些函数生成的新值会任意分布在很大的空间内，这会减慢INSERT和某些类型的SELECT查询的速度：  
> ⏱ 2024-01-08 11:50:13 ^3300035678-16-23460-23660

> 📌 如果存储通用唯一标识符(UUID)值，则应该删除破折号，或者更好的做法是，使用UNHEX()函数将UUID值转换为16字节的数字，并将其存储在一个BINARY(16)列中。可以使用HEX()函数以十六进制格式检索值。  
> ⏱ 2024-01-08 11:50:57 ^3300035678-16-24001-24109

> 📌 MySQL提供了INET_ATON()和INET_NTOA()函数来在这两种表示形式之间进行转换。使用的空间从VARCHAR(15)的约16字节缩减到无符号32位整数的4字节。如果你担心数据库的可读性，不想继续使用函数查看行数据，请记住MySQL有视图，可以使用视图来简化数据查看的复杂性。  
> ⏱ 2024-01-08 11:53:01 ^3300035678-16-25001-25146

> 📌 即使需要在表中存储事实上的“空值”，也可能不需要使用NULL。也许可以使用0、特殊值或空字符串作为代替。  
> ⏱ 2024-01-08 12:00:23 ^3300035678-16-27090-27142

## 第7章 创建高性能的索引

> 📌 在MySQL中，索引是在存储引擎层而不是服务器层实现的  
> ⏱ 2024-01-09 17:08:36 ^3300035678-17-2261-2288

> 📌 InnoDB则使用的是B+tree  
> ⏱ 2024-01-09 17:09:32 ^3300035678-17-3003-3020

> 📌 自适应哈希索引。InnoDB存储引擎有一个被称为自适应哈希索引的特性。当InnoDB发现某些索引值被非常频繁地被访问时，它会在原有的B-tree索引之上，在内存中再构建一个哈希索引。  
> ⏱ 2024-01-09 17:12:21 ^3300035678-17-4702-4793

> 📌 B-tree索引通常可以支持“只访问索引的查询”，即查询只需要访问索引，而无须访问数据行。后面我们将单独讨论这种“覆盖索引”的优化。  
> ⏱ 2024-01-09 17:13:22 ^3300035678-17-5844-5910

> 📌 ●索引大大减少了服务器需要扫描的数据量。
●索引可以帮助服务器避免排序和临时表。
●索引可以将随机I/O变为顺序I/O。  
> ⏱ 2024-01-09 17:28:43 ^3300035678-17-7486-7602

> 📌 “三星系统”(three-star system)评价体系，用以判断一个索引是不是适合某个查询语句：索引将相关的记录放到一起则获得“一星”；如果索引中的数据顺序和查找中的排列顺序一致则获得“二星”；如果索引中的列包含了查询中需要的全部列则获得“三星”。  
> ⏱ 2024-01-09 17:30:21 ^3300035678-17-7897-8023

> 📌 有时候为了提升索引的性能，同时也节省索引空间，可以只对字段的前一部分字符进行索引，这样做的缺点是，会降低索引的选择性。索引的选择性是指，不重复的索引值（也称为基数，cardinality）和数据表的记录总数(＃T)的比值，范围从1/＃T到1之间。索引的选择性越高则查询效率越高  
> ⏱ 2024-01-09 17:31:46 ^3300035678-17-8636-8774

> 📌 对于BLOB、TEXT或者很长的VARCHAR类型的列，必须使用前缀索引，因为MySQL并不支持对这些列的完整内容进行索引。  
> ⏱ 2024-01-09 17:32:25 ^3300035678-17-8892-8954

> 📌 查询显示，当前缀长度到达7的时候，再增加前缀长度，选择性提升的幅度已经很小了。  
> ⏱ 2024-01-09 17:34:34 ^3300035678-17-11189-11228

> 📌 MySQL无法使用前缀索引做ORDER BY和GROUP BY操作，也无法使用前缀索引做覆盖扫描。  
> ⏱ 2024-01-09 17:35:32 ^3300035678-17-12081-12130

> 📌  使用UNION改写查询，往往是最好的办法。 ^3300035678-17-14062-14083
- 💭 And条件使用联合索引，or条件建议使用union - ⏱ 2024-01-09 17:41:33 

> 📌 如果在EXPLAIN中看到有索引合并，那么就应该好好检查一下查询语句的写法和表的结构，看是不是已经是最优的。  
> ⏱ 2024-01-09 17:48:52 ^3300035678-17-14112-14166

# 读书笔记

## 第7章 创建高性能的索引

### 划线评论
> 📌 使用UNION改写查询，往往是最好的办法。  ^439222474-7O5Qdd6db
    - 💭 And条件使用联合索引，or条件建议使用union
    - ⏱ 2024-01-09 17:41:44
   
# 本书评论
